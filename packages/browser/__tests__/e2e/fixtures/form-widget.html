<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>E2E Test: Form Widget</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css" />
  <style>
    body { margin: 0; padding: 20px; background: #000; }
    #terminal { width: 800px; height: 600px; }
  </style>
</head>
<body>
  <div id="terminal"></div>
  
  <script type="module">
    import { Terminal } from 'https://cdn.jsdelivr.net/npm/xterm@5.3.0/+esm';
    import { Screen, Button, Form, Text, Textbox } from '../../../dist/index.js';
    const term = new Terminal({ rows: 24, cols: 80 });
    term.open(document.getElementById('terminal'));
    const screen = new Screen({ terminal: term });
    window.formData = null;

    const form = new Form({
      parent: screen,
      keys: true,
      left: 'center',
      top: 'center',
      width: 50,
      height: 15,
      border: 'line',
      style: { border: { fg: 'cyan' } }
    });

    const nameLabel = new Text({ parent: form, top: 1, left: 2, content: 'Name:' });
    const nameInput = new Textbox({ parent: form, top: 2, left: 2, height: 3, width: 40, border: 'line', keys: true, name: 'name' });

    const emailLabel = new Text({ parent: form, top: 5, left: 2, content: 'Email:' });
    const emailInput = new Textbox({ parent: form, top: 6, left: 2, height: 3, width: 40, border: 'line', keys: true, name: 'email' });

    const submit = new Button({ parent: form, top: 10, left: 2, content: 'Submit', border: 'line', padding: { left: 1, right: 1 }, keys: true });

    nameInput.on('focus', function() {
      nameInput.readInput();
    });

    emailInput.on('focus', function() {
      emailInput.readInput();
    });

    form.on('submit', function(data) {
      window.formData = data;
    });

    submit.on('press', function() {
      form.submit();
    });

    nameInput.focus();
    screen.render();

    window.testForm = form;
    window.testScreen = screen;
    window.testReady = true;
  </script>
</body>
</html>
